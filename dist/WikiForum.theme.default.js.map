{"version":3,"sources":["webpack://mediawiki-wikiforum/./theme/default/default.js"],"names":["mw","hook","add","next","allForumsContainer","ctx","$","append","newForumContainer","forumContainer","meta","id","newThreadContainer","threadContainer","String","content","cxt","timePublish","timeRelease","release","timeModify","userAuthor","user","userLast","$idLink","text","$userLink","href","util","getUrl","$content","html","$timeArea","Date","toLocaleString","$firstThread","title","$normalThread","newReplyContainer","noForumContainer"],"mappings":"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","file":"WikiForum.theme.default.js","sourcesContent":["/**\n * @function theme.default 标准的官方主题\n * @param {Object} ctx\n * @param {Object} ctx.meta Metadata\n *\n * @param {Function} next\n */\nmw.hook('WikiForum.theme').add(next => {\n  // 全论坛容器\n  var allForumsContainer = ctx => {\n    return $('<div>', { class: 'wiki-forum-all-container' }).append(\n      newForumContainer()\n    )\n  }\n\n  // 单论坛容器\n  var forumContainer = ctx => {\n    return $('<div>', {\n      class: 'wiki-forum',\n      'data-forumid': ctx.meta.id,\n    }).append(newThreadContainer())\n  }\n\n  // 帖子容器\n  var threadContainer = ctx => {\n    // 处理 meta\n    const id = String(ctx.meta.id)\n    const content = cxt.content\n    const timePublish =\n      ctx.meta.timePublish || ctx.meta.timeRelease || ctx.meta.release || ''\n    const timeModify = ctx.meta.timeModify || timePublish\n    const userAuthor = ctx.meta.userAuthor || ctx.meta.user || 'unsigned'\n    const userLast = ctx.meta.userLast || userAuthor\n\n    // 缓存组件\n    var $idLink = $('<span>', { class: 'forum-id-link', text: '#' + id })\n    var $userLink = $('<div>', { class: 'forum-user' }).append(\n      $('<span>', { class: 'forum-user-link' }).append(\n        $('<a>', {\n          class: 'mw-userlink userAuthor',\n          text: userAuthor,\n          href: mw.util.getUrl('User:' + userAuthor),\n        })\n      )\n    )\n    var $content = $('<div>', { class: 'forum-content', html: content })\n    var $timeArea = $('<div>', { class: 'post-time' }).append(\n      $('<i>', {\n        class: 'post-date timePublish',\n        text: new Date(timePublish).toLocaleString(),\n      })\n    )\n\n    // 楼主\n    var $firstThread = $('<div>', { class: 'forum-thread forum-first' }).append(\n      $('<div>', { class: 'forum-before' }).append(\n        $('<h3>', { class: 'forum-title', text: ctx.meta.title }),\n        $idLink,\n        $userLink\n      ),\n      $content,\n      $('<div>', { class: 'forum-after' }).append($timeArea)\n    )\n\n    // 普通帖子\n    var $normalThread = $('<div>', { class: 'forum-thread' }).append(\n      $('<div>', { class: 'forum-before' }).append($idLink, $userLink),\n      $content,\n      $('<div>', { class: 'forum-after' }).append(\n        $timeArea,\n        newReplyContainer()\n      )\n    )\n\n    // 判断是否为楼主，并返回帖子容器\n    if (id === '1') {\n      return $firstThread\n    } else {\n      return $normalThread\n    }\n  }\n\n  // 新回复容器\n  var newReplyContainer = ctx => {\n    return $('<div>').append($('<p>', { text: 'newReplyContainer' }))\n  }\n\n  // 新帖子容器\n  var newThreadContainer = ctx => {\n    return $('<div>').append($('<p>', { text: 'newThreadContainer' }))\n  }\n\n  // 新论坛容器\n  var newForumContainer = ctx => {\n    return $('<div>').append($('<p>', { text: 'newForumContainer' }))\n  }\n\n  // 无论坛容器\n  var noForumContainer = ctx => {}\n\n  next &&\n    next({\n      allForumsContainer,\n      forumContainer,\n      threadContainer,\n    })\n})\n"],"sourceRoot":""}