{"version":3,"sources":["webpack://mediawiki-wikiforum/./theme/default.js"],"names":["settings","$","extend","loadStyle","adminGroup","adminUser","depthMax","enableNewForum","enableModify","enableDelete","window","WikiForumDefaultTheme","mw","loader","load","hook","add","next","_msg","i","list","conf","config","get","allForumsContainer","ctx","forumContainer","meta","id","threadContainer","forumid","threadid","content","timePublish","timeRelease","release","timeModify","userAuthor","user","userLast","htmlId","$idLink","text","href","click","e","preventDefault","history","pushState","$block","animate","scrollTop","offset","top","$userLink","append","util","getUrl","$content","html","$timeArea","dateFormat","Date","forumMeta","title","reactionContainer","$root","$container","_forum","fn","$replyArea","newReplyArea","forumEl","show","hide","$textArea","$submitBtn","val","addClass","updater","addReply","newThreadArea","addThread","likeList","reactionLike","split","likeTotal","length","isLike","includes","wgUserName","$likeBtn","index","indexOf","splice","push","sort","join","updateThread","newForumContainer","noForumContainer","afterForum","afterAllForums","fmt","date","o","getMonth","getDate","getHours","getMinutes","getSeconds","Math","floor","S","getMilliseconds","test","replace","RegExp","$1","getFullYear","substr","k"],"mappings":";;;;;;;;;;;;;;AAAA;AACA,IAAMA,QAAQ,GAAGC,CAAC,CAACC,MAAF,CACf,EADe,EAEf;AACEC,WAAS,EAAE,IADb;AAEEC,YAAU,EAAE,CAAC,OAAD,CAFd;AAGEC,WAAS,EAAE,EAHb;AAIEC,UAAQ,EAAE,CAJZ;AAKEC,gBAAc,EAAE,KALlB;AAMEC,cAAY,EAAE,IANhB;AAOEC,cAAY,EAAE;AAPhB,CAFe,EAWfC,MAAM,CAACC,qBAXQ,CAAjB,C,CAcA;;AACA,IAAIX,QAAQ,CAACG,SAAT,KAAuB,KAA3B,EAAkC;AAChCS,IAAE,CAACC,MAAH,CAAUC,IAAV,CACE,yEADF,EAEE,UAFF;AAID;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAF,EAAE,CAACG,IAAH,CAAQ,iBAAR,EAA2BC,GAA3B,CAA+B,UAAAC,IAAI,EAAI;AACrC;AACA;AACA;AACA,WAASC,IAAT,CAAcC,CAAd,EAAiB;AACf,QAAMC,IAAI,GAAG;AACX,0BAAoB,MADT;AAEX,qBAAe,oBAFJ;AAGX,2BAAqB,SAHV;AAIX,8BAAwB,UAJb;AAKX,6BAAuB,cALZ;AAMX,mBAAa,IANF;AAOX,oBAAc,IAPH;AAQX,mBAAa;AARF,KAAb;AAUA,WAAOA,IAAI,CAACD,CAAD,CAAJ,yBAAyBA,CAAzB,MAAP;AACD;;AAED,MAAME,IAAI,GAAGT,EAAE,CAACU,MAAH,CAAUC,GAAV,EAAb,CAlBqC,CAoBrC;;AACA,MAAIC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,GAAG,EAAI;AAC9B,WAAOxB,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO;AAAT,KAAV,CAAR;AACD,GAFD,CArBqC,CAyBrC;;;AACA,MAAIyB,cAAc,GAAG,SAAjBA,cAAiB,CAAAD,GAAG,EAAI;AAC1B,WAAOxB,CAAC,CAAC,OAAD,EAAU;AAChB,eAAO,YADS;AAEhB,sBAAgBwB,GAAG,CAACE,IAAJ,CAASC;AAFT,KAAV,CAAR;AAID,GALD,CA1BqC,CAiCrC;;;AACA,MAAIC,eAAe,GAAG,SAAlBA,eAAkB,CAAAJ,GAAG,EAAI;AAC3B;AAD2B,QAEnBK,OAFmB,GAEYL,GAFZ,CAEnBK,OAFmB;AAAA,QAEVC,QAFU,GAEYN,GAFZ,CAEVM,QAFU;AAAA,QAEAC,OAFA,GAEYP,GAFZ,CAEAO,OAFA;AAG3B,QAAMC,WAAW,GACfR,GAAG,CAACE,IAAJ,CAASM,WAAT,IAAwBR,GAAG,CAACE,IAAJ,CAASO,WAAjC,IAAgDT,GAAG,CAACE,IAAJ,CAASQ,OAAzD,IAAoE,EADtE;AAEA,QAAMC,UAAU,GAAGX,GAAG,CAACE,IAAJ,CAASS,UAAT,IAAuBH,WAA1C;AACA,QAAMI,UAAU,GAAGZ,GAAG,CAACE,IAAJ,CAASU,UAAT,IAAuBZ,GAAG,CAACE,IAAJ,CAASW,IAAhC,IAAwC,UAA3D;AACA,QAAMC,QAAQ,GAAGd,GAAG,CAACE,IAAJ,CAASY,QAAT,IAAqBF,UAAtC;AACA,QAAMG,MAAM,mBAAYV,OAAZ,qBAA8BC,QAA9B,CAAZ,CAR2B,CAU3B;;AACA,QAAIU,OAAO,GAAGxC,CAAC,CAAC,KAAD,EAAQ;AACrB,eAAO,eADc;AAErByC,UAAI,EAAE,MAAMX,QAFS;AAGrBY,UAAI,aAAMH,MAAN;AAHiB,KAAR,CAAD,CAIXI,KAJW,CAIL,UAAUC,CAAV,EAAa;AACpBA,OAAC,CAACC,cAAF;AACApC,YAAM,CAACqC,OAAP,CAAeC,SAAf,CAAyB,IAAzB,EAA+B,IAA/B,EAAqC,MAAMR,MAA3C;AACA,UAAMS,MAAM,GAAGhD,CAAC,CAAC,MAAMuC,MAAP,CAAhB;AACAvC,OAAC,CAAC,WAAD,CAAD,CAAeiD,OAAf,CAAuB;AAAEC,iBAAS,EAAEF,MAAM,CAACG,MAAP,GAAgBC,GAAhB,GAAsB;AAAnC,OAAvB,EAAiE,GAAjE;AACD,KATa,CAAd;AAUA,QAAIC,SAAS,GAAGrD,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO;AAAT,KAAV,CAAD,CAAoCsD,MAApC,CACdtD,CAAC,CAAC,QAAD,EAAW;AAAE,eAAO;AAAT,KAAX,CAAD,CAA0CsD,MAA1C,CACEtD,CAAC,CAAC,KAAD,EAAQ;AACP,eAAO,wBADA;AAEPyC,UAAI,EAAEL,UAFC;AAGPM,UAAI,EAAE/B,EAAE,CAAC4C,IAAH,CAAQC,MAAR,CAAe,UAAUpB,UAAzB;AAHC,KAAR,CADH,EAMEE,QAAQ,KAAKF,UAAb,GACI,EADJ,GAEIpC,CAAC,CAAC,KAAD,EAAQ;AAAEyC,UAAI,cAAOxB,IAAI,CAAC,WAAD,CAAX,eAA6BqB,QAA7B;AAAN,KAAR,CARP,CADc,CAAhB;AAYA,QAAImB,QAAQ,GAAGzD,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO,eAAT;AAA0B0D,UAAI,EAAE3B;AAAhC,KAAV,CAAhB;AACA,QAAI4B,SAAS,GAAG3D,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO;AAAT,KAAV,CAAD,CAAmCsD,MAAnC,CACdtD,CAAC,CAAC,KAAD,EAAQ;AACP,eAAO,uBADA;AAEPyC,UAAI,EAAEmB,UAAU,CAAC3C,IAAI,CAAC,aAAD,CAAL,EAAsB,IAAI4C,IAAJ,CAAS7B,WAAT,CAAtB;AAFT,KAAR,CADa,CAAhB,CAlC2B,CAyC3B;;AACA,QAAIF,QAAQ,KAAK,GAAjB,EAAsB;AACpB;AACA,aAAO9B,CAAC,CAAC,OAAD,EAAU;AAChB2B,UAAE,EAAEY,MADY;AAEhB,iBAAO;AAFS,OAAV,CAAD,CAGJe,MAHI,CAILtD,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO;AAAT,OAAV,CAAD,CAAsCsD,MAAtC,CACEtD,CAAC,CAAC,MAAD,EAAS;AACR,iBAAO,aADC;AAERyC,YAAI,EAAEjB,GAAG,CAACsC,SAAJ,CAAcC,KAAd,IAAuB,6BAA6BlC;AAFlD,OAAT,CADH,EAKEW,OALF,EAMEa,SANF,CAJK,EAYLI,QAZK,EAaLzD,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO;AAAT,OAAV,CAAD,CAAqCsD,MAArC,CACEK,SADF,EAEEK,iBAAiB,CAACxC,GAAD,CAFnB,CAbK,CAAP;AAkBD,KApBD,MAoBO;AACL;AADK,UAEGyC,KAFH,GAE8CzC,GAF9C,CAEGyC,KAFH;AAAA,UAEUC,UAFV,GAE8C1C,GAF9C,CAEU0C,UAFV;AAAA,UAEsBrC,QAFtB,GAE8CL,GAF9C,CAEsBK,OAFtB;AAAA,UAE+BsC,MAF/B,GAE8C3C,GAF9C,CAE+B2C,MAF/B;AAAA,UAEuCC,EAFvC,GAE8C5C,GAF9C,CAEuC4C,EAFvC;AAGL,UAAIC,UAAU,GAAGC,YAAY,CAAC;AAC5BL,aAAK,EAALA,KAD4B;AAE5BC,kBAAU,EAAVA,UAF4B;AAG5BK,eAAO,EAAEJ,MAHmB;AAI5BtC,eAAO,EAAPA,QAJ4B;AAK5BC,gBAAQ,EAARA,QAL4B;AAM5BsC,UAAE,EAAFA;AAN4B,OAAD,CAA7B;AASA,aAAOpE,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO,cAAT;AAAyB2B,UAAE,EAAEY;AAA7B,OAAV,CAAD,CAAkDe,MAAlD,CACLtD,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO;AAAT,OAAV,CAAD,CAAsCsD,MAAtC,CAA6Cd,OAA7C,EAAsDa,SAAtD,CADK,EAELI,QAFK,EAGLzD,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO;AAAT,OAAV,CAAD,CAAqCsD,MAArC,CACEK,SADF,EAEE3D,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO;AAAT,OAAV,CAAD,CAA6CsD,MAA7C,CACEtD,CAAC,CAAC,OAAD,EAAU;AAAE,iBAAO;AAAT,OAAV,CAAD,CAA8CsD,MAA9C,CACEtD,CAAC,CAAC,KAAD,EAAQ;AACP,iBAAO,WADA;AAEP0C,YAAI,EAAE,cAFC;AAGPD,YAAI,EAAExB,IAAI,CAAC,WAAD;AAHH,OAAR,CAAD,CAIG0B,KAJH,CAIS,UAAUC,CAAV,EAAa;AACpByB,kBAAU,CAACG,IAAX;AACAxE,SAAC,CAAC,IAAD,CAAD,CAAQyE,IAAR;AACD,OAPD,CADF,CADF,EAWEJ,UAXF,CAFF,EAeEL,iBAAiB,CAACxC,GAAD,CAfnB,CAHK,CAAP;AAqBD;AACF,GAhGD,CAlCqC,CAoIrC;;;AACA,MAAI8C,YAAY,GAAG,SAAfA,YAAe,CAAA9C,GAAG,EAAI;AAAA,QAChByC,KADgB,GACsBzC,GADtB,CAChByC,KADgB;AAAA,QACTM,OADS,GACsB/C,GADtB,CACT+C,OADS;AAAA,QACA1C,OADA,GACsBL,GADtB,CACAK,OADA;AAAA,QACSC,QADT,GACsBN,GADtB,CACSM,QADT;AAGxB,QAAIoC,UAAU,GAAGlE,CAAC,CAAC,OAAD,EAAU;AAC1B,eAAO;AADmB,KAAV,CAAlB;AAGA,QAAI0E,SAAS,GAAG1E,CAAC,CAAC,YAAD,EAAe;AAAE,eAAO;AAAT,KAAf,CAAjB;AACA,QAAI2E,UAAU,GAAG3E,CAAC,CAAC,UAAD,EAAa;AAC7ByC,UAAI,EAAExB,IAAI,CAAC,WAAD,CADmB;AAE7B,eAAO;AAFsB,KAAb,CAAD,CAGd0B,KAHc,CAGR,YAAY;AACnB,UAAIZ,OAAO,GAAG2C,SAAS,CAACE,GAAV,EAAd;AACA,UAAI,CAAC7C,OAAL,EAAc;AAEdmC,gBAAU,CAACW,QAAX,CAAoB,eAApB;AACArD,SAAG,CAAC4C,EAAJ,CAAOU,OAAP,CAAeC,QAAf,CAAwB;AACtBd,aAAK,EAALA,KADsB;AAEtBM,eAAO,EAAPA,OAFsB;AAGtBxC,eAAO,EAAPA,OAHsB;AAItBF,eAAO,EAAPA,OAJsB;AAKtBC,gBAAQ,EAARA;AALsB,OAAxB;AAOD,KAfgB,CAAjB;AAiBAoC,cAAU,CAACZ,MAAX,CACEtD,CAAC,CAAC,SAAD,EAAY;AAAE,eAAO;AAAT,KAAZ,CAAD,CAAiDsD,MAAjD,CACEtD,CAAC,CAAC,OAAD,CAAD,CAAWsD,MAAX,CAAkBoB,SAAlB,CADF,EAEE1E,CAAC,CAAC,OAAD,CAAD,CAAWsD,MAAX,CAAkBqB,UAAlB,CAFF,CADF;AAOA,WAAOT,UAAP;AACD,GAhCD,CArIqC,CAuKrC;;;AACA,MAAIc,aAAa,GAAG,SAAhBA,aAAgB,CAAAxD,GAAG,EAAI;AAAA,QACjByC,KADiB,GACUzC,GADV,CACjByC,KADiB;AAAA,QACVE,MADU,GACU3C,GADV,CACV2C,MADU;AAAA,QACFtC,OADE,GACUL,GADV,CACFK,OADE;AAGzB,QAAIqC,UAAU,GAAGlE,CAAC,CAAC,OAAD,EAAU;AAC1B,eAAO;AADmB,KAAV,CAAlB;AAGA,QAAI0E,SAAS,GAAG1E,CAAC,CAAC,YAAD,EAAe;AAAE,eAAO;AAAT,KAAf,CAAjB;AACA,QAAI2E,UAAU,GAAG3E,CAAC,CAAC,UAAD,EAAa;AAC7ByC,UAAI,EAAExB,IAAI,CAAC,YAAD,CADmB;AAE7B,eAAO;AAFsB,KAAb,CAAD,CAGd0B,KAHc,CAGR,YAAY;AACnB,UAAIZ,OAAO,GAAG2C,SAAS,CAACE,GAAV,EAAd;AACA,UAAI,CAAC7C,OAAL,EAAc;AAEdmC,gBAAU,CAACW,QAAX,CAAoB,eAApB;AACArD,SAAG,CAAC4C,EAAJ,CAAOU,OAAP,CAAeG,SAAf,CAAyB;AAAEhB,aAAK,EAALA,KAAF;AAASM,eAAO,EAAEJ,MAAlB;AAA0BtC,eAAO,EAAPA,OAA1B;AAAmCE,eAAO,EAAPA;AAAnC,OAAzB;AACD,KATgB,CAAjB;AAWAmC,cAAU,CAACZ,MAAX,CACEtD,CAAC,CAAC,UAAD,EAAa;AAAEyC,UAAI,EAAExB,IAAI,CAAC,kBAAD;AAAZ,KAAb,CADH,EAEEjB,CAAC,CAAC,SAAD,EAAY;AAAE,eAAO;AAAT,KAAZ,CAAD,CAAiDsD,MAAjD,CACEtD,CAAC,CAAC,OAAD,CAAD,CAAWsD,MAAX,CAAkBoB,SAAlB,CADF,EAEE1E,CAAC,CAAC,OAAD,CAAD,CAAWsD,MAAX,CAAkBqB,UAAlB,CAFF,CAFF;AAQA,WAAOT,UAAP;AACD,GA3BD,CAxKqC,CAqMrC;;;AACA,MAAIF,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAxC,GAAG,EAAI;AAAA,QACrB2C,MADqB,GACmB3C,GADnB,CACrB2C,MADqB;AAAA,QACbtC,OADa,GACmBL,GADnB,CACbK,OADa;AAAA,QACJC,QADI,GACmBN,GADnB,CACJM,QADI;AAAA,QACMJ,IADN,GACmBF,GADnB,CACME,IADN;AAAA,QACY0C,EADZ,GACmB5C,GADnB,CACY4C,EADZ;AAG7B,QAAMF,UAAU,GAAGlE,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO;AAAT,KAAV,CAApB,CAH6B,CAK7B;;AACA,QAAIkF,QAAQ,GAAGxD,IAAI,CAACyD,YAAL,IAAqB,EAApC;;AACA,QAAID,QAAJ,EAAc;AACZA,cAAQ,GAAGA,QAAQ,CAACE,KAAT,CAAe,GAAf,CAAX;AACD,KAFD,MAEO;AACLF,cAAQ,GAAG,EAAX;AACD;;AACD,QAAIG,SAAS,GAAGH,QAAQ,CAACI,MAAzB;AACA,QAAIC,MAAM,GAAGL,QAAQ,CAACM,QAAT,CAAkBpE,IAAI,CAACqE,UAAvB,CAAb;AAEAC,YAAQ,GAAG1F,CAAC,CAAC,KAAD,EAAQ;AAClB0C,UAAI,EAAE,cADY;AAElB,eAAO,eAFW;AAGlBD,UAAI,yBAAQ4C,SAAR,MAHc;AAIlBtB,WAAK,EAAEwB,MAAM,GAAGtE,IAAI,CAAC,sBAAD,CAAP,GAAkCA,IAAI,CAAC,mBAAD;AAJjC,KAAR,CAAD,CAMR4D,QANQ,CAMCU,MAAM,GAAG,SAAH,GAAe,UANtB,EAOR5C,KAPQ,CAOF,YAAY;AACjBuB,gBAAU,CAACW,QAAX,CAAoB,eAApB;;AACA,UAAIU,MAAJ,EAAY;AACV,YAAII,KAAK,GAAGT,QAAQ,CAACU,OAAT,CAAiBxE,IAAI,CAACqE,UAAtB,CAAZ;AACA,YAAIE,KAAK,GAAG,CAAC,CAAb,EAAgBT,QAAQ,CAACW,MAAT,CAAgBF,KAAhB,EAAuB,CAAvB;AACjB,OAHD,MAGO;AACLT,gBAAQ,CAACY,IAAT,CAAc1E,IAAI,CAACqE,UAAnB;AACD;;AACDP,cAAQ,CAACa,IAAT;AACAb,cAAQ,GAAGA,QAAQ,CAACc,IAAT,CAAc,GAAd,CAAX;AACA5B,QAAE,CAACU,OAAH,CAAWmB,YAAX,CAAwB;AACtB1B,eAAO,EAAEJ,MADa;AAEtBtC,eAAO,EAAPA,OAFsB;AAGtBC,gBAAQ,EAARA,QAHsB;AAItBJ,YAAI,EAAE;AAAEyD,sBAAY,EAAED;AAAhB;AAJgB,OAAxB;AAMD,KAvBQ,CAAX;AAyBAhB,cAAU,CAACZ,MAAX,CAAkBoC,QAAlB;AAEA,WAAOxB,UAAP;AACD,GA3CD,CAtMqC,CAmPrC;;;AACA,MAAIgC,iBAAiB,GAAG,SAApBA,iBAAoB,CAAA1E,GAAG,EAAI;AAC7B,WAAOxB,CAAC,CAAC,OAAD,CAAD,CAAWsD,MAAX,CAAkBtD,CAAC,CAAC,KAAD,EAAQ;AAAEyC,UAAI,EAAE;AAAR,KAAR,CAAnB,CAAP;AACD,GAFD,CApPqC,CAwPrC;;;AACA,MAAI0D,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAA3E,GAAG,EAAI,CAAE,CAAhC;;AAEA,MAAI4E,UAAU,GAAG,SAAbA,UAAa,CAAA5E,GAAG,EAAI;AACtB,WAAOxB,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO;AAAT,KAAV,CAAD,CAAuDsD,MAAvD,CACL0B,aAAa,CAACxD,GAAD,CADR,CAAP;AAGD,GAJD;;AAMA,MAAI6E,cAAc,GAAG,SAAjBA,cAAiB,CAAA7E,GAAG,EAAI;AAC1B,WAAOxB,CAAC,CAAC,OAAD,EAAU;AAAE,eAAO;AAAT,KAAV,CAAD,CAA0CsD,MAA1C,CACL4C,iBAAiB,CAAC1E,GAAD,CADZ,CAAP;AAGD,GAJD,CAjQqC,CAuQrC;;;AACA,WAASoC,UAAT,CAAoB0C,GAApB,EAAyBC,IAAzB,EAA+B;AAC7BA,QAAI,GAAGA,IAAI,IAAI,IAAI1C,IAAJ,EAAf;AACA,QAAI2C,CAAC,GAAG;AACN,YAAMD,IAAI,CAACE,QAAL,KAAkB,CADlB;AACqB;AAC3B,YAAMF,IAAI,CAACG,OAAL,EAFA;AAEgB;AACtB,YAAMH,IAAI,CAACI,QAAL,EAHA;AAGiB;AACvB,YAAMJ,IAAI,CAACK,UAAL,EAJA;AAImB;AACzB,YAAML,IAAI,CAACM,UAAL,EALA;AAKmB;AACzB,YAAMC,IAAI,CAACC,KAAL,CAAW,CAACR,IAAI,CAACE,QAAL,KAAkB,CAAnB,IAAwB,CAAnC,CANA;AAMuC;AAC7CO,OAAC,EAAET,IAAI,CAACU,eAAL,EAPG,CAOqB;;AAPrB,KAAR;;AASA,QAAI,OAAOC,IAAP,CAAYZ,GAAZ,CAAJ,EAAsB;AACpBA,SAAG,GAAGA,GAAG,CAACa,OAAJ,CACJC,MAAM,CAACC,EADH,EAEJ,CAACd,IAAI,CAACe,WAAL,KAAqB,EAAtB,EAA0BC,MAA1B,CAAiC,IAAIH,MAAM,CAACC,EAAP,CAAU/B,MAA/C,CAFI,CAAN;AAID;;AACD,SAAK,IAAIkC,CAAT,IAAchB,CAAd;AACE,UAAI,IAAIY,MAAJ,CAAW,MAAMI,CAAN,GAAU,GAArB,EAA0BN,IAA1B,CAA+BZ,GAA/B,CAAJ,EAAyC;AACvCA,WAAG,GAAGA,GAAG,CAACa,OAAJ,CACJC,MAAM,CAACC,EADH,EAEJD,MAAM,CAACC,EAAP,CAAU/B,MAAV,IAAoB,CAApB,GACIkB,CAAC,CAACgB,CAAD,CADL,GAEI,CAAC,OAAOhB,CAAC,CAACgB,CAAD,CAAT,EAAcD,MAAd,CAAqB,CAAC,KAAKf,CAAC,CAACgB,CAAD,CAAP,EAAYlC,MAAjC,CAJA,CAAN;AAMD;AARH;;AASA,WAAOgB,GAAP;AACD;;AAEDtF,MAAI,IACFA,IAAI,CAAC;AACHO,sBAAkB,EAAlBA,kBADG;AAEHE,kBAAc,EAAdA,cAFG;AAGHG,mBAAe,EAAfA,eAHG;AAIHyE,kBAAc,EAAdA,cAJG;AAKHD,cAAU,EAAVA,UALG;AAMHD,oBAAgB,EAAhBA;AANG,GAAD,CADN;AASD,CA9SD,E","file":"WikiForum.theme.default.js","sourcesContent":["// Theme settings\nconst settings = $.extend(\n  {},\n  {\n    loadStyle: true,\n    adminGroup: ['sysop'],\n    adminUser: [],\n    depthMax: 3,\n    enableNewForum: false,\n    enableModify: true,\n    enableDelete: true,\n  },\n  window.WikiForumDefaultTheme\n)\n\n// Import style\nif (settings.loadStyle !== false) {\n  mw.loader.load(\n    'https://proj.wjghj.cn/Gadget-WikiForum/dist/WikiForum.theme.default.css',\n    'text/css'\n  )\n}\n\n/**\n * @function theme.default 标准的官方主题\n * @param {Object} ctx\n * @param {Object} ctx.meta Metadata\n *\n * @param {Function} next\n */\nmw.hook('WikiForum.theme').add(next => {\n  // function _msg(...params) {\n  //   return i18n.msg(...params).parse()\n  // }\n  function _msg(i) {\n    const list = {\n      'add-thread-label': '回复楼主',\n      'date-format': 'yyyy年M月d日 hh:mm:ss',\n      'reaction-like-add': '给这个帖子点赞',\n      'reaction-like-remove': '取消点赞这个帖子',\n      'reaction-like-total': '有$1名用户赞了这个帖子',\n      'reply-btn': '回复',\n      'submit-btn': '发送',\n      'user-last': '修改者',\n    }\n    return list[i] || `{WikiForum-${i}}`\n  }\n\n  const conf = mw.config.get()\n\n  // 全论坛容器\n  var allForumsContainer = ctx => {\n    return $('<div>', { class: 'wiki-forum-all-container' })\n  }\n\n  // 单论坛容器\n  var forumContainer = ctx => {\n    return $('<div>', {\n      class: 'wiki-forum',\n      'data-forumid': ctx.meta.id,\n    })\n  }\n\n  // 帖子容器\n  var threadContainer = ctx => {\n    // 处理 meta\n    const { forumid, threadid, content } = ctx\n    const timePublish =\n      ctx.meta.timePublish || ctx.meta.timeRelease || ctx.meta.release || ''\n    const timeModify = ctx.meta.timeModify || timePublish\n    const userAuthor = ctx.meta.userAuthor || ctx.meta.user || 'unsigned'\n    const userLast = ctx.meta.userLast || userAuthor\n    const htmlId = `forum-${forumid}_thread-${threadid}`\n\n    // 缓存组件\n    var $idLink = $('<a>', {\n      class: 'forum-id-link',\n      text: '#' + threadid,\n      href: `#${htmlId}`,\n    }).click(function (e) {\n      e.preventDefault()\n      window.history.pushState(null, null, '#' + htmlId)\n      const $block = $('#' + htmlId)\n      $('html,body').animate({ scrollTop: $block.offset().top - 100 }, 500)\n    })\n    var $userLink = $('<div>', { class: 'forum-user' }).append(\n      $('<span>', { class: 'forum-user-link' }).append(\n        $('<a>', {\n          class: 'mw-userlink userAuthor',\n          text: userAuthor,\n          href: mw.util.getUrl('User:' + userAuthor),\n        }),\n        userLast === userAuthor\n          ? ''\n          : $('<i>', { text: ` (${_msg('user-last')}: ${userLast})` })\n      )\n    )\n    var $content = $('<div>', { class: 'forum-content', html: content })\n    var $timeArea = $('<div>', { class: 'post-time' }).append(\n      $('<i>', {\n        class: 'post-date timePublish',\n        text: dateFormat(_msg('date-format'), new Date(timePublish)),\n      })\n    )\n\n    // 判断是否为楼主，并返回帖子容器\n    if (threadid === '1') {\n      // 楼主\n      return $('<div>', {\n        id: htmlId,\n        class: 'forum-thread forum-first',\n      }).append(\n        $('<div>', { class: 'forum-before' }).append(\n          $('<h3>', {\n            class: 'forum-title',\n            text: ctx.forumMeta.title || '[UNTITLED] Forum Topic #' + forumid,\n          }),\n          $idLink,\n          $userLink\n        ),\n        $content,\n        $('<div>', { class: 'forum-after' }).append(\n          $timeArea,\n          reactionContainer(ctx)\n        )\n      )\n    } else {\n      // 普通帖子\n      const { $root, $container, forumid, _forum, fn } = ctx\n      var $replyArea = newReplyArea({\n        $root,\n        $container,\n        forumEl: _forum,\n        forumid,\n        threadid,\n        fn,\n      })\n\n      return $('<div>', { class: 'forum-thread', id: htmlId }).append(\n        $('<div>', { class: 'forum-before' }).append($idLink, $userLink),\n        $content,\n        $('<div>', { class: 'forum-after' }).append(\n          $timeArea,\n          $('<div>', { class: 'new-reply-container' }).append(\n            $('<div>', { class: 'modify-buttons-group' }).append(\n              $('<a>', {\n                class: 'reply-btn',\n                href: 'javascript:;',\n                text: _msg('reply-btn'),\n              }).click(function (e) {\n                $replyArea.show()\n                $(this).hide()\n              })\n            ),\n            $replyArea\n          ),\n          reactionContainer(ctx)\n        )\n      )\n    }\n  }\n\n  // 新回复容器\n  var newReplyArea = ctx => {\n    const { $root, forumEl, forumid, threadid } = ctx\n\n    var $container = $('<div>', {\n      class: 'forum-new-reply-area',\n    })\n    var $textArea = $('<textarea>', { class: 'forum-textarea' })\n    var $submitBtn = $('<button>', {\n      text: _msg('reply-btn'),\n      class: 'forum-submit-btn',\n    }).click(function () {\n      var content = $textArea.val()\n      if (!content) return\n\n      $container.addClass('forum-loading')\n      ctx.fn.updater.addReply({\n        $root,\n        forumEl,\n        content,\n        forumid,\n        threadid,\n      })\n    })\n\n    $container.append(\n      $('<label>', { class: 'forum-input-container' }).append(\n        $('<div>').append($textArea),\n        $('<div>').append($submitBtn)\n      )\n    )\n\n    return $container\n  }\n\n  // 新帖子容器\n  var newThreadArea = ctx => {\n    const { $root, _forum, forumid } = ctx\n\n    var $container = $('<div>', {\n      class: 'forum-new-thread-area',\n    })\n    var $textArea = $('<textarea>', { class: 'forum-textarea' })\n    var $submitBtn = $('<button>', {\n      text: _msg('submit-btn'),\n      class: 'forum-submit-btn',\n    }).click(function () {\n      var content = $textArea.val()\n      if (!content) return\n\n      $container.addClass('forum-loading')\n      ctx.fn.updater.addThread({ $root, forumEl: _forum, forumid, content })\n    })\n\n    $container.append(\n      $('<strong>', { text: _msg('add-thread-label') }),\n      $('<label>', { class: 'forum-input-container' }).append(\n        $('<div>').append($textArea),\n        $('<div>').append($submitBtn)\n      )\n    )\n\n    return $container\n  }\n\n  // 点赞容器\n  var reactionContainer = ctx => {\n    const { _forum, forumid, threadid, meta, fn } = ctx\n\n    const $container = $('<div>', { class: 'forum-reaction' })\n\n    // Like btn\n    let likeList = meta.reactionLike || ''\n    if (likeList) {\n      likeList = likeList.split('|')\n    } else {\n      likeList = []\n    }\n    let likeTotal = likeList.length\n    let isLike = likeList.includes(conf.wgUserName)\n\n    $likeBtn = $('<a>', {\n      href: 'javascript:;',\n      class: 'reaction-like',\n      text: `👍(${likeTotal})`,\n      title: isLike ? _msg('reaction-like-remove') : _msg('reaction-like-add'),\n    })\n      .addClass(isLike ? 'is-like' : 'not-like')\n      .click(function () {\n        $container.addClass('forum-loading')\n        if (isLike) {\n          let index = likeList.indexOf(conf.wgUserName)\n          if (index > -1) likeList.splice(index, 1)\n        } else {\n          likeList.push(conf.wgUserName)\n        }\n        likeList.sort()\n        likeList = likeList.join('|')\n        fn.updater.updateThread({\n          forumEl: _forum,\n          forumid,\n          threadid,\n          meta: { reactionLike: likeList },\n        })\n      })\n\n    $container.append($likeBtn)\n\n    return $container\n  }\n\n  // 新论坛容器\n  var newForumContainer = ctx => {\n    return $('<div>').append($('<p>', { text: 'newForumContainer' }))\n  }\n\n  // 无论坛容器\n  var noForumContainer = ctx => {}\n\n  var afterForum = ctx => {\n    return $('<div>', { class: 'forum-thread forum-add-thread' }).append(\n      newThreadArea(ctx)\n    )\n  }\n\n  var afterAllForums = ctx => {\n    return $('<div>', { class: 'after-all-forums' }).append(\n      newForumContainer(ctx)\n    )\n  }\n\n  // @function dateFormat\n  function dateFormat(fmt, date) {\n    date = date || new Date()\n    var o = {\n      'M+': date.getMonth() + 1, //月份\n      'd+': date.getDate(), //日\n      'h+': date.getHours(), //小时\n      'm+': date.getMinutes(), //分\n      's+': date.getSeconds(), //秒\n      'q+': Math.floor((date.getMonth() + 3) / 3), //季度\n      S: date.getMilliseconds(), //毫秒\n    }\n    if (/(y+)/.test(fmt)) {\n      fmt = fmt.replace(\n        RegExp.$1,\n        (date.getFullYear() + '').substr(4 - RegExp.$1.length)\n      )\n    }\n    for (var k in o)\n      if (new RegExp('(' + k + ')').test(fmt)) {\n        fmt = fmt.replace(\n          RegExp.$1,\n          RegExp.$1.length == 1\n            ? o[k]\n            : ('00' + o[k]).substr(('' + o[k]).length)\n        )\n      }\n    return fmt\n  }\n\n  next &&\n    next({\n      allForumsContainer,\n      forumContainer,\n      threadContainer,\n      afterAllForums,\n      afterForum,\n      noForumContainer,\n    })\n})\n"],"sourceRoot":""}