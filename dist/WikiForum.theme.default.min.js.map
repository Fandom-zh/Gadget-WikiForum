{"version":3,"sources":["webpack://mediawiki-wikiforum/./theme/default/default.js"],"names":["mw","hook","add","next","allForumsContainer","ctx","$","class","append","text","forumContainer","meta","id","threadContainer","String","content","timePublish","timeRelease","release","userAuthor","timeModify","user","userLast","$idLink","$userLink","href","util","getUrl","$content","html","$timeArea","Date","toLocaleString","$firstThread","title","$normalThread"],"mappings":";AAOAA,GAAGC,KAAK,mBAAmBC,KAAI,SAAAC,GA0H7BA,GACEA,EAAK,CACHC,mBA1HqB,SAAAC,GACvB,OAAOC,EAAE,QAAS,CAAEC,MAAO,6BAA8BC,OAiHlDF,EAAE,SAASE,OAAOF,EAAE,MAAO,CAAEG,KAAM,yBASxCC,eApHiB,SAAAL,GACnB,OAAOC,EAAE,QAAS,CAChBC,MAAO,aACP,eAAgBF,EAAIM,KAAKC,KACxBJ,OAkGIF,EAAE,SAASE,OAAOF,EAAE,MAAO,CAAEG,KAAM,0BAexCI,gBA7GkB,SAAAR,GAEpB,IAAMO,EAAKE,OAAOT,EAAIO,IAChBG,EAAUV,EAAIU,QACdC,EACJX,EAAIM,KAAKK,aAAeX,EAAIM,KAAKM,aAAeZ,EAAIM,KAAKO,SAAW,GAEhEC,GADad,EAAIM,KAAKS,WACTf,EAAIM,KAAKQ,YAAcd,EAAIM,KAAKU,MAAQ,YACrDC,EAAWjB,EAAIM,KAAKW,UAAYH,EAGlCI,EAAUjB,EAAE,SAAU,CAAEC,MAAO,gBAAiBE,KAAM,IAAMG,IAC5DY,EAAYlB,EAAE,QAAS,CAAEC,MAAO,eAAgBC,OAClDF,EAAE,SAAU,CAAEC,MAAO,oBAAqBC,OACxCF,EAAE,MAAO,CACPC,MAAO,yBACPE,KAAMU,EACNM,KAAMzB,GAAG0B,KAAKC,OAAO,QAAUR,KAEjCG,IAAaH,EACT,GACAb,EAAE,MAAO,CAAEG,KAAM,QAAUa,EAAW,QAG1CM,EAAWtB,EAAE,QAAS,CAAEC,MAAO,gBAAiBsB,KAAMd,IACtDe,EAAYxB,EAAE,QAAS,CAAEC,MAAO,cAAeC,OACjDF,EAAE,MAAO,CACPC,MAAO,wBACPE,KAAM,IAAIsB,KAAKf,GAAagB,oBAK5BC,EAAe3B,EAAE,QAAS,CAAEC,MAAO,6BAA8BC,OACnEF,EAAE,QAAS,CAAEC,MAAO,iBAAkBC,OACpCF,EAAE,OAAQ,CAAEC,MAAO,cAAeE,KAAMJ,EAAIM,KAAKuB,QACjDX,EACAC,GAEFI,EACAtB,EAAE,QAAS,CAAEC,MAAO,gBAAiBC,OAAOsB,IAI1CK,EAAgB7B,EAAE,QAAS,CAAEC,MAAO,iBAAkBC,OACxDF,EAAE,QAAS,CAAEC,MAAO,iBAAkBC,OAAOe,EAASC,GACtDI,EACAtB,EAAE,QAAS,CAAEC,MAAO,gBAAiBC,OACnCsB,EAeGxB,EAAE,SAASE,OAAOF,EAAE,MAAO,CAAEG,KAAM,yBAT1C,MAAW,MAAPG,EACKqB,EAEAE","file":"WikiForum.theme.default.min.js","sourcesContent":["/**\r\n * @function theme.default 标准的官方主题\r\n * @param {Object} ctx\r\n * @param {Object} ctx.meta Metadata\r\n *\r\n * @param {Function} next\r\n */\r\nmw.hook('WikiForum.theme').add(next => {\r\n  // 全论坛容器\r\n  var allForumsContainer = ctx => {\r\n    return $('<div>', { class: 'wiki-forum-all-container' }).append(\r\n      newForumContainer()\r\n    )\r\n  }\r\n\r\n  // 单论坛容器\r\n  var forumContainer = ctx => {\r\n    return $('<div>', {\r\n      class: 'wiki-forum',\r\n      'data-forumid': ctx.meta.id,\r\n    }).append(newThreadContainer())\r\n  }\r\n\r\n  // 帖子容器\r\n  var threadContainer = ctx => {\r\n    // 处理 meta\r\n    const id = String(ctx.id)\r\n    const content = ctx.content\r\n    const timePublish =\r\n      ctx.meta.timePublish || ctx.meta.timeRelease || ctx.meta.release || ''\r\n    const timeModify = ctx.meta.timeModify || timePublish\r\n    const userAuthor = ctx.meta.userAuthor || ctx.meta.user || 'unsigned'\r\n    const userLast = ctx.meta.userLast || userAuthor\r\n\r\n    // 缓存组件\r\n    var $idLink = $('<span>', { class: 'forum-id-link', text: '#' + id })\r\n    var $userLink = $('<div>', { class: 'forum-user' }).append(\r\n      $('<span>', { class: 'forum-user-link' }).append(\r\n        $('<a>', {\r\n          class: 'mw-userlink userAuthor',\r\n          text: userAuthor,\r\n          href: mw.util.getUrl('User:' + userAuthor),\r\n        }),\r\n        userLast === userAuthor\r\n          ? ''\r\n          : $('<i>', { text: '（修改者：' + userLast + '）' })\r\n      )\r\n    )\r\n    var $content = $('<div>', { class: 'forum-content', html: content })\r\n    var $timeArea = $('<div>', { class: 'post-time' }).append(\r\n      $('<i>', {\r\n        class: 'post-date timePublish',\r\n        text: new Date(timePublish).toLocaleString(),\r\n      })\r\n    )\r\n\r\n    // 楼主\r\n    var $firstThread = $('<div>', { class: 'forum-thread forum-first' }).append(\r\n      $('<div>', { class: 'forum-before' }).append(\r\n        $('<h3>', { class: 'forum-title', text: ctx.meta.title }),\r\n        $idLink,\r\n        $userLink\r\n      ),\r\n      $content,\r\n      $('<div>', { class: 'forum-after' }).append($timeArea)\r\n    )\r\n\r\n    // 普通帖子\r\n    var $normalThread = $('<div>', { class: 'forum-thread' }).append(\r\n      $('<div>', { class: 'forum-before' }).append($idLink, $userLink),\r\n      $content,\r\n      $('<div>', { class: 'forum-after' }).append(\r\n        $timeArea,\r\n        newReplyContainer()\r\n      )\r\n    )\r\n\r\n    // 判断是否为楼主，并返回帖子容器\r\n    if (id === '1') {\r\n      return $firstThread\r\n    } else {\r\n      return $normalThread\r\n    }\r\n  }\r\n\r\n  // 新回复容器\r\n  var newReplyContainer = ctx => {\r\n    return $('<div>').append($('<p>', { text: 'newReplyContainer' }))\r\n  }\r\n\r\n  // 新帖子容器\r\n  var newThreadContainer = ctx => {\r\n    //   var $textArea = $('<textarea>', { class: 'forum-textarea' })\r\n    //   var $submitBtn = $('<button>', {\r\n    //     text: '提交',\r\n    //     class: 'forum-submit-btn',\r\n    //   }).click(function() {\r\n    //     var content = $textArea.val()\r\n    //     if (!content) return\r\n    //     newThread({\r\n    //       forumEl,\r\n    //       forumid,\r\n    //       content,\r\n    //     })\r\n    //   })\r\n\r\n    //   var $container = $('<div>', {\r\n    //     class: 'forum-new-thread-area',\r\n    //     'data-debug': JSON.stringify({\r\n    //       forumid,\r\n    //     }),\r\n    //   }).append(\r\n    //     $('<label>', { class: 'forum-input-container' }).append(\r\n    //       $('<div>').append($textArea),\r\n    //       $('<div>').append($submitBtn)\r\n    //     )\r\n    //   )\r\n\r\n    return $('<div>').append($('<p>', { text: 'newThreadContainer' }))\r\n  }\r\n\r\n  // 新论坛容器\r\n  var newForumContainer = ctx => {\r\n    return $('<div>').append($('<p>', { text: 'newForumContainer' }))\r\n  }\r\n\r\n  // 无论坛容器\r\n  var noForumContainer = ctx => {}\r\n\r\n  next &&\r\n    next({\r\n      allForumsContainer,\r\n      forumContainer,\r\n      threadContainer,\r\n    })\r\n})\r\n"],"sourceRoot":""}