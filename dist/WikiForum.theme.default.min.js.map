{"version":3,"sources":["webpack://mediawiki-wikiforum/./theme/default/default.js"],"names":["mw","hook","add","next","allForumsContainer","ctx","$","class","append","text","forumContainer","meta","id","$textArea","$submitBtn","click","content","val","newThread","forumEl","forumid","JSON","stringify","threadContainer","String","cxt","timePublish","timeRelease","release","userAuthor","timeModify","user","$idLink","userLast","$userLink","href","util","getUrl","$content","html","$timeArea","Date","toLocaleString","$firstThread","title","$normalThread"],"mappings":";AAOAA,GAAGC,KAAK,mBAAmBC,KAAI,SAAAC,GAuH7BA,GACEA,EAAK,CACHC,mBAvHqB,SAAAC,GACvB,OAAOC,EAAE,QAAS,CAAEC,MAAO,6BAA8BC,OA8GlDF,EAAE,SAASE,OAAOF,EAAE,MAAO,CAAEG,KAAM,yBASxCC,eAjHiB,SAAAL,GACnB,OAAOC,EAAE,QAAS,CAChBC,MAAO,aACP,eAAgBF,EAAIM,KAAKC,KACxBJ,QAqECK,EAAYP,EAAE,aAAc,CAAEC,MAAO,mBACrCO,EAAaR,EAAE,WAAY,CAC7BG,KAAM,KACNF,MAAO,qBACNQ,OAAM,WACP,IAAIC,EAAUH,EAAUI,MACnBD,GACLE,UAAU,CACRC,gBACAC,gBACAJ,eAIaV,EAAE,QAAS,CAC1BC,MAAO,wBACP,aAAcc,KAAKC,UAAU,CAC3BF,oBAEDZ,OACDF,EAAE,UAAW,CAAEC,MAAO,0BAA2BC,OAC/CF,EAAE,SAASE,OAAOK,GAClBP,EAAE,SAASE,OAAOM,KAIfR,EAAE,SAASE,OAAOF,EAAE,MAAO,CAAEG,KAAM,0BA3BnB,IACnBI,EACAC,GAwCFS,gBA1GkB,SAAAlB,GAEpB,IAAMO,EAAKY,OAAOnB,EAAIM,KAAKC,IACrBI,EAAUS,IAAIT,QACdU,EACJrB,EAAIM,KAAKe,aAAerB,EAAIM,KAAKgB,aAAetB,EAAIM,KAAKiB,SAAW,GAEhEC,GADaxB,EAAIM,KAAKmB,WACTzB,EAAIM,KAAKkB,YAAcxB,EAAIM,KAAKoB,MAAQ,YAIvDC,GAHa3B,EAAIM,KAAKsB,SAGZ3B,EAAE,SAAU,CAAEC,MAAO,gBAAiBE,KAAM,IAAMG,KAC5DsB,EAAY5B,EAAE,QAAS,CAAEC,MAAO,eAAgBC,OAClDF,EAAE,SAAU,CAAEC,MAAO,oBAAqBC,OACxCF,EAAE,MAAO,CACPC,MAAO,yBACPE,KAAMoB,EACNM,KAAMnC,GAAGoC,KAAKC,OAAO,QAAUR,OAIjCS,EAAWhC,EAAE,QAAS,CAAEC,MAAO,gBAAiBgC,KAAMvB,IACtDwB,EAAYlC,EAAE,QAAS,CAAEC,MAAO,cAAeC,OACjDF,EAAE,MAAO,CACPC,MAAO,wBACPE,KAAM,IAAIgC,KAAKf,GAAagB,oBAK5BC,EAAerC,EAAE,QAAS,CAAEC,MAAO,6BAA8BC,OACnEF,EAAE,QAAS,CAAEC,MAAO,iBAAkBC,OACpCF,EAAE,OAAQ,CAAEC,MAAO,cAAeE,KAAMJ,EAAIM,KAAKiC,QACjDZ,EACAE,GAEFI,EACAhC,EAAE,QAAS,CAAEC,MAAO,gBAAiBC,OAAOgC,IAI1CK,EAAgBvC,EAAE,QAAS,CAAEC,MAAO,iBAAkBC,OACxDF,EAAE,QAAS,CAAEC,MAAO,iBAAkBC,OAAOwB,EAASE,GACtDI,EACAhC,EAAE,QAAS,CAAEC,MAAO,gBAAiBC,OACnCgC,EAeGlC,EAAE,SAASE,OAAOF,EAAE,MAAO,CAAEG,KAAM,yBAT1C,MAAW,MAAPG,EACK+B,EAEAE","file":"WikiForum.theme.default.min.js","sourcesContent":["/**\r\n * @function theme.default 标准的官方主题\r\n * @param {Object} ctx\r\n * @param {Object} ctx.meta Metadata\r\n *\r\n * @param {Function} next\r\n */\r\nmw.hook('WikiForum.theme').add(next => {\r\n  // 全论坛容器\r\n  var allForumsContainer = ctx => {\r\n    return $('<div>', { class: 'wiki-forum-all-container' }).append(\r\n      newForumContainer()\r\n    )\r\n  }\r\n\r\n  // 单论坛容器\r\n  var forumContainer = ctx => {\r\n    return $('<div>', {\r\n      class: 'wiki-forum',\r\n      'data-forumid': ctx.meta.id,\r\n    }).append(newThreadContainer())\r\n  }\r\n\r\n  // 帖子容器\r\n  var threadContainer = ctx => {\r\n    // 处理 meta\r\n    const id = String(ctx.meta.id)\r\n    const content = cxt.content\r\n    const timePublish =\r\n      ctx.meta.timePublish || ctx.meta.timeRelease || ctx.meta.release || ''\r\n    const timeModify = ctx.meta.timeModify || timePublish\r\n    const userAuthor = ctx.meta.userAuthor || ctx.meta.user || 'unsigned'\r\n    const userLast = ctx.meta.userLast || userAuthor\r\n\r\n    // 缓存组件\r\n    var $idLink = $('<span>', { class: 'forum-id-link', text: '#' + id })\r\n    var $userLink = $('<div>', { class: 'forum-user' }).append(\r\n      $('<span>', { class: 'forum-user-link' }).append(\r\n        $('<a>', {\r\n          class: 'mw-userlink userAuthor',\r\n          text: userAuthor,\r\n          href: mw.util.getUrl('User:' + userAuthor),\r\n        })\r\n      )\r\n    )\r\n    var $content = $('<div>', { class: 'forum-content', html: content })\r\n    var $timeArea = $('<div>', { class: 'post-time' }).append(\r\n      $('<i>', {\r\n        class: 'post-date timePublish',\r\n        text: new Date(timePublish).toLocaleString(),\r\n      })\r\n    )\r\n\r\n    // 楼主\r\n    var $firstThread = $('<div>', { class: 'forum-thread forum-first' }).append(\r\n      $('<div>', { class: 'forum-before' }).append(\r\n        $('<h3>', { class: 'forum-title', text: ctx.meta.title }),\r\n        $idLink,\r\n        $userLink\r\n      ),\r\n      $content,\r\n      $('<div>', { class: 'forum-after' }).append($timeArea)\r\n    )\r\n\r\n    // 普通帖子\r\n    var $normalThread = $('<div>', { class: 'forum-thread' }).append(\r\n      $('<div>', { class: 'forum-before' }).append($idLink, $userLink),\r\n      $content,\r\n      $('<div>', { class: 'forum-after' }).append(\r\n        $timeArea,\r\n        newReplyContainer()\r\n      )\r\n    )\r\n\r\n    // 判断是否为楼主，并返回帖子容器\r\n    if (id === '1') {\r\n      return $firstThread\r\n    } else {\r\n      return $normalThread\r\n    }\r\n  }\r\n\r\n  // 新回复容器\r\n  var newReplyContainer = ctx => {\r\n    return $('<div>').append($('<p>', { text: 'newReplyContainer' }))\r\n  }\r\n\r\n  // 新帖子容器\r\n  var newThreadContainer = ctx => {\r\n    var $textArea = $('<textarea>', { class: 'forum-textarea' })\r\n    var $submitBtn = $('<button>', {\r\n      text: '提交',\r\n      class: 'forum-submit-btn',\r\n    }).click(function() {\r\n      var content = $textArea.val()\r\n      if (!content) return\r\n      newThread({\r\n        forumEl,\r\n        forumid,\r\n        content,\r\n      })\r\n    })\r\n\r\n    var $container = $('<div>', {\r\n      class: 'forum-new-thread-area',\r\n      'data-debug': JSON.stringify({\r\n        forumid,\r\n      }),\r\n    }).append(\r\n      $('<label>', { class: 'forum-input-container' }).append(\r\n        $('<div>').append($textArea),\r\n        $('<div>').append($submitBtn)\r\n      )\r\n    )\r\n\r\n    return $('<div>').append($('<p>', { text: 'newThreadContainer' }))\r\n  }\r\n\r\n  // 新论坛容器\r\n  var newForumContainer = ctx => {\r\n    return $('<div>').append($('<p>', { text: 'newForumContainer' }))\r\n  }\r\n\r\n  // 无论坛容器\r\n  var noForumContainer = ctx => {}\r\n\r\n  next &&\r\n    next({\r\n      allForumsContainer,\r\n      forumContainer,\r\n      threadContainer,\r\n    })\r\n})\r\n"],"sourceRoot":""}