{"version":3,"sources":["webpack://mediawiki-wikiforum/./theme/fandom.js"],"names":["settings","window","WikiForumDefaultTheme","loadStyle","importArticle","type","articles","article","mw","hook","add","i18no","loadMessages","then","main","i18n","_msg","msg","parse","next","allForumsContainer","ctx","$","forumContainer","meta","id","threadContainer","forumid","threadid","content","timePublish","timeRelease","release","timeModify","userAuthor","user","userLast","htmlId","$idLink","text","href","click","e","preventDefault","history","pushState","location","split","$block","animate","scrollTop","offset","top","$userLink","append","util","getUrl","$content","html","$timeArea","dateFormat","Date","forumMeta","title","_forum","fn","$replyArea","newReplyArea","forumEl","show","hide","$container","$textArea","$submitBtn","val","addClass","updater","addReply","newThreadArea","addThread","newForumContainer","noForumContainer","afterForum","afterAllForums","handleLoading","container","fmt","date","o","getMonth","getDate","getHours","getMinutes","getSeconds","Math","floor","S","getMilliseconds","test","replace","RegExp","$1","getFullYear","substr","length","k"],"mappings":"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","file":"WikiForum.theme.fandom.js","sourcesContent":["const settings = window.WikiForumDefaultTheme || {}\n\n// Import style\nif (settings.loadStyle !== false) {\n  importArticle({\n    type: 'style',\n    articles: ['u:dev:MediaWiki:WikiForum/theme/default.css'],\n  })\n}\n\n// Wait i18n-js\nimportArticle({\n  type: 'script',\n  article: 'u:dev:MediaWiki:I18n-js/code.js',\n})\nmw.hook('dev.i18n').add(function(i18no) {\n  i18no.loadMessages('WikiForum-theme-default').then(main)\n})\n\n// function main\nfunction main(i18n) {\n  function _msg(...params) {\n    return i18n.msg(...params).parse()\n  }\n\n  /**\n   * @function theme.default 标准的官方主题\n   * @param {Object} ctx\n   * @param {Object} ctx.meta Metadata\n   *\n   * @param {Function} next\n   */\n  mw.hook('WikiForum.theme').add(next => {\n    // 全论坛容器\n    var allForumsContainer = ctx => {\n      return $('<div>', { class: 'wiki-forum-all-container' })\n    }\n\n    // 单论坛容器\n    var forumContainer = ctx => {\n      return $('<div>', {\n        class: 'wiki-forum',\n        'data-forumid': ctx.meta.id,\n      })\n    }\n\n    // 帖子容器\n    var threadContainer = ctx => {\n      // 处理 meta\n      const { forumid, threadid, content } = ctx\n      const timePublish =\n        ctx.meta.timePublish || ctx.meta.timeRelease || ctx.meta.release || ''\n      const timeModify = ctx.meta.timeModify || timePublish\n      const userAuthor = ctx.meta.userAuthor || ctx.meta.user || 'unsigned'\n      const userLast = ctx.meta.userLast || userAuthor\n      const htmlId = `forum-${forumid}_thread-${threadid}`\n\n      // 缓存组件\n      var $idLink = $('<a>', {\n        class: 'forum-id-link',\n        text: '#' + threadid,\n        href: `#${htmlId}`,\n      }).click(function(e) {\n        e.preventDefault()\n        window.history.pushState(\n          null,\n          null,\n          window.location.href.split('#')[0] + '#' + htmlId\n        )\n        const $block = $('#' + htmlId)\n        $('html,body').animate({ scrollTop: $block.offset().top - 100 }, 500)\n      })\n      var $userLink = $('<div>', { class: 'forum-user' }).append(\n        $('<span>', { class: 'forum-user-link' }).append(\n          $('<a>', {\n            class: 'mw-userlink userAuthor',\n            text: userAuthor,\n            href: mw.util.getUrl('User:' + userAuthor),\n          }),\n          userLast === userAuthor\n            ? ''\n            : $('<i>', { text: ` (${_msg('user-last')}：${userLast})` })\n        )\n      )\n      var $content = $('<div>', { class: 'forum-content', html: content })\n      var $timeArea = $('<div>', { class: 'post-time' }).append(\n        $('<i>', {\n          class: 'post-date timePublish',\n          text: dateFormat(_msg('date-format'), new Date(timePublish)),\n        })\n      )\n\n      // 判断是否为楼主，并返回帖子容器\n      if (threadid === '1') {\n        // 楼主\n        return $('<div>', {\n          id: htmlId,\n          class: 'forum-thread forum-first',\n        }).append(\n          $('<div>', { class: 'forum-before' }).append(\n            $('<h3>', {\n              class: 'forum-title',\n              text: ctx.forumMeta.title || '[UNTITLED] Forum Topic #' + forumid,\n            }),\n            $idLink,\n            $userLink\n          ),\n          $content,\n          $('<div>', { class: 'forum-after' }).append($timeArea)\n        )\n      } else {\n        // 普通帖子\n        const { forumid, _forum, fn } = ctx\n        var $replyArea = newReplyArea({\n          forumEl: _forum,\n          forumid,\n          threadid,\n          fn,\n        })\n\n        return $('<div>', { class: 'forum-thread', id: htmlId }).append(\n          $('<div>', { class: 'forum-before' }).append($idLink, $userLink),\n          $content,\n          $('<div>', { class: 'forum-after' }).append(\n            $timeArea,\n            $('<div>', { class: 'new-reply-container' }).append(\n              $('<div>', { class: 'modify-buttons-group' }).append(\n                $('<a>', {\n                  class: 'reply-btn',\n                  href: 'javascript:;',\n                  text: _msg('reply-btn'),\n                }).click(function(e) {\n                  $replyArea.show()\n                  $(this).hide()\n                })\n              ),\n              $replyArea\n            )\n          )\n        )\n      }\n    }\n\n    // 新回复容器\n    var newReplyArea = ctx => {\n      var $container = $('<div>', {\n        class: 'forum-new-reply-area',\n      })\n      var $textArea = $('<textarea>', { class: 'forum-textarea' })\n      var $submitBtn = $('<button>', {\n        text: _msg('reply-btn'),\n        class: 'forum-submit-btn',\n      }).click(function() {\n        var content = $textArea.val()\n        if (!content) return\n\n        $container.addClass('forum-loading')\n        const { forumEl, forumid, threadid } = ctx\n        ctx.fn.updater.addReply({\n          forumEl,\n          content,\n          forumid,\n          threadid,\n        })\n      })\n\n      $container.append(\n        $('<label>', { class: 'forum-input-container' }).append(\n          $('<div>').append($textArea),\n          $('<div>').append($submitBtn)\n        )\n      )\n\n      return $container\n    }\n\n    // 新帖子容器\n    var newThreadArea = ctx => {\n      const { _forum, forumid } = ctx\n\n      var $container = $('<div>', {\n        class: 'forum-new-thread-area',\n      })\n      var $textArea = $('<textarea>', { class: 'forum-textarea' })\n      var $submitBtn = $('<button>', {\n        text: _msg('submit-btn'),\n        class: 'forum-submit-btn',\n      }).click(function() {\n        var content = $textArea.val()\n        if (!content) return\n\n        $container.addClass('forum-loading')\n        ctx.fn.updater.addThread({\n          forumEl: _forum,\n          forumid,\n          content,\n        })\n      })\n\n      $container.append(\n        $('<strong>', { text: _msg('add-thread-label') }),\n        $('<label>', { class: 'forum-input-container' }).append(\n          $('<div>').append($textArea),\n          $('<div>').append($submitBtn)\n        )\n      )\n\n      return $container\n    }\n\n    // 新论坛容器\n    var newForumContainer = ctx => {\n      return $('<div>').append($('<p>', { text: 'newForumContainer' }))\n    }\n\n    // 无论坛容器\n    var noForumContainer = ctx => {}\n\n    var afterForum = ctx => {\n      return $('<div>', { class: 'forum-thread forum-add-thread' }).append(\n        newThreadArea(ctx)\n      )\n    }\n\n    var afterAllForums = ctx => {\n      return newForumContainer(ctx)\n    }\n\n    var handleLoading = container => {\n      $(container).addClass('forum-loading')\n    }\n\n    // @function dateFormat\n    function dateFormat(fmt, date) {\n      date = date || new Date()\n      var o = {\n        'M+': date.getMonth() + 1, //月份\n        'd+': date.getDate(), //日\n        'h+': date.getHours(), //小时\n        'm+': date.getMinutes(), //分\n        's+': date.getSeconds(), //秒\n        'q+': Math.floor((date.getMonth() + 3) / 3), //季度\n        S: date.getMilliseconds(), //毫秒\n      }\n      if (/(y+)/.test(fmt)) {\n        fmt = fmt.replace(\n          RegExp.$1,\n          (date.getFullYear() + '').substr(4 - RegExp.$1.length)\n        )\n      }\n      for (var k in o)\n        if (new RegExp('(' + k + ')').test(fmt)) {\n          fmt = fmt.replace(\n            RegExp.$1,\n            RegExp.$1.length == 1\n              ? o[k]\n              : ('00' + o[k]).substr(('' + o[k]).length)\n          )\n        }\n      return fmt\n    }\n\n    next &&\n      next({\n        allForumsContainer,\n        forumContainer,\n        threadContainer,\n        afterAllForums,\n        afterForum,\n        noForumContainer,\n        handleLoading,\n      })\n  })\n}\n"],"sourceRoot":""}