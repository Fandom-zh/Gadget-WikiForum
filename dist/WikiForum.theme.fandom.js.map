{"version":3,"sources":["webpack://mediawiki-wikiforum/./theme/fandom.js"],"names":["settings","$","extend","loadStyle","adminGroup","adminUser","depthMax","enableNewForum","enableModify","enableDelete","window","WikiForumDefaultTheme","importArticle","type","articles","article","mw","hook","add","i18no","loadMessages","then","main","i18n","next","_msg","msg","parse","conf","config","get","allForumsContainer","ctx","forumContainer","meta","id","threadContainer","forumid","threadid","content","timePublish","timeRelease","release","timeModify","userAuthor","user","userLast","htmlId","$idLink","text","href","click","e","preventDefault","history","pushState","$block","animate","scrollTop","offset","top","$userLink","append","util","getUrl","$content","html","$timeArea","dateFormat","Date","forumMeta","title","reactionContainer","$root","$container","_forum","fn","$replyArea","newReplyArea","forumEl","show","hide","$textArea","$submitBtn","val","addClass","updater","addReply","newThreadArea","addThread","likeList","reactionLike","split","likeTotal","length","isLike","includes","wgUserName","$likeBtn","index","indexOf","splice","push","sort","join","updateThread","newForumContainer","noForumContainer","afterForum","afterAllForums","fmt","date","o","getMonth","getDate","getHours","getMinutes","getSeconds","Math","floor","S","getMilliseconds","test","replace","RegExp","$1","getFullYear","substr","k"],"mappings":"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","file":"WikiForum.theme.fandom.js","sourcesContent":["// Theme settings\nconst settings = $.extend(\n  {},\n  {\n    loadStyle: true,\n    adminGroup: ['sysop'],\n    adminUser: [],\n    depthMax: 3,\n    enableNewForum: false,\n    enableModify: true,\n    enableDelete: true,\n  },\n  window.WikiForumDefaultTheme\n)\n\n// Import style\nif (settings.loadStyle !== false) {\n  importArticle({\n    type: 'style',\n    articles: ['u:dev:MediaWiki:WikiForum/theme/default.css'],\n  })\n}\n\n// Wait i18n-js\nimportArticle({\n  type: 'script',\n  article: 'u:dev:MediaWiki:I18n-js/code.js',\n})\nmw.hook('dev.i18n').add(function (i18no) {\n  i18no.loadMessages('WikiForum-theme-default').then(main)\n})\n\n// function main\nfunction main(i18n) {\n  /**\n   * @function theme.default 标准的官方主题\n   * @param {Object} ctx\n   * @param {Object} ctx.meta Metadata\n   *\n   * @param {Function} next\n   */\n  mw.hook('WikiForum.theme').add(next => {\n    function _msg(...params) {\n      return i18n.msg(...params).parse()\n    }\n\n    const conf = mw.config.get()\n\n    // 全论坛容器\n    var allForumsContainer = ctx => {\n      return $('<div>', { class: 'wiki-forum-all-container' })\n    }\n\n    // 单论坛容器\n    var forumContainer = ctx => {\n      return $('<div>', {\n        class: 'wiki-forum',\n        'data-forumid': ctx.meta.id,\n      })\n    }\n\n    // 帖子容器\n    var threadContainer = ctx => {\n      // 处理 meta\n      const { forumid, threadid, content } = ctx\n      const timePublish =\n        ctx.meta.timePublish || ctx.meta.timeRelease || ctx.meta.release || ''\n      const timeModify = ctx.meta.timeModify || timePublish\n      const userAuthor = ctx.meta.userAuthor || ctx.meta.user || 'unsigned'\n      const userLast = ctx.meta.userLast || userAuthor\n      const htmlId = `forum-${forumid}_thread-${threadid}`\n\n      // 缓存组件\n      var $idLink = $('<a>', {\n        class: 'forum-id-link',\n        text: '#' + threadid,\n        href: `#${htmlId}`,\n      }).click(function (e) {\n        e.preventDefault()\n        window.history.pushState(null, null, '#' + htmlId)\n        const $block = $('#' + htmlId)\n        $('html,body').animate({ scrollTop: $block.offset().top - 100 }, 500)\n      })\n      var $userLink = $('<div>', { class: 'forum-user' }).append(\n        $('<span>', { class: 'forum-user-link' }).append(\n          $('<a>', {\n            class: 'mw-userlink userAuthor',\n            text: userAuthor,\n            href: mw.util.getUrl('User:' + userAuthor),\n          }),\n          userLast === userAuthor\n            ? ''\n            : $('<i>', { text: ` (${_msg('user-last')}: ${userLast})` })\n        )\n      )\n      var $content = $('<div>', { class: 'forum-content', html: content })\n      var $timeArea = $('<div>', { class: 'post-time' }).append(\n        $('<i>', {\n          class: 'post-date timePublish',\n          text: dateFormat(_msg('date-format'), new Date(timePublish)),\n        })\n      )\n\n      // 判断是否为楼主，并返回帖子容器\n      if (threadid === '1') {\n        // 楼主\n        return $('<div>', {\n          id: htmlId,\n          class: 'forum-thread forum-first',\n        }).append(\n          $('<div>', { class: 'forum-before' }).append(\n            $('<h3>', {\n              class: 'forum-title',\n              text: ctx.forumMeta.title || '[UNTITLED] Forum Topic #' + forumid,\n            }),\n            $idLink,\n            $userLink\n          ),\n          $content,\n          $('<div>', { class: 'forum-after' }).append(\n            $timeArea,\n            reactionContainer(ctx)\n          )\n        )\n      } else {\n        // 普通帖子\n        const { $root, $container, forumid, _forum, fn } = ctx\n        var $replyArea = newReplyArea({\n          $root,\n          $container,\n          forumEl: _forum,\n          forumid,\n          threadid,\n          fn,\n        })\n\n        return $('<div>', { class: 'forum-thread', id: htmlId }).append(\n          $('<div>', { class: 'forum-before' }).append($idLink, $userLink),\n          $content,\n          $('<div>', { class: 'forum-after' }).append(\n            $timeArea,\n            $('<div>', { class: 'new-reply-container' }).append(\n              $('<div>', { class: 'modify-buttons-group' }).append(\n                $('<a>', {\n                  class: 'reply-btn',\n                  href: 'javascript:;',\n                  text: _msg('reply-btn'),\n                }).click(function (e) {\n                  $replyArea.show()\n                  $(this).hide()\n                })\n              ),\n              $replyArea\n            ),\n            reactionContainer(ctx)\n          )\n        )\n      }\n    }\n\n    // 新回复容器\n    var newReplyArea = ctx => {\n      const { $root, forumEl, forumid, threadid } = ctx\n\n      var $container = $('<div>', {\n        class: 'forum-new-reply-area',\n      })\n      var $textArea = $('<textarea>', { class: 'forum-textarea' })\n      var $submitBtn = $('<button>', {\n        text: _msg('reply-btn'),\n        class: 'forum-submit-btn',\n      }).click(function () {\n        var content = $textArea.val()\n        if (!content) return\n\n        $container.addClass('forum-loading')\n        ctx.fn.updater.addReply({\n          $root,\n          forumEl,\n          content,\n          forumid,\n          threadid,\n        })\n      })\n\n      $container.append(\n        $('<label>', { class: 'forum-input-container' }).append(\n          $('<div>').append($textArea),\n          $('<div>').append($submitBtn)\n        )\n      )\n\n      return $container\n    }\n\n    // 新帖子容器\n    var newThreadArea = ctx => {\n      const { $root, _forum, forumid } = ctx\n\n      var $container = $('<div>', {\n        class: 'forum-new-thread-area',\n      })\n      var $textArea = $('<textarea>', { class: 'forum-textarea' })\n      var $submitBtn = $('<button>', {\n        text: _msg('submit-btn'),\n        class: 'forum-submit-btn',\n      }).click(function () {\n        var content = $textArea.val()\n        if (!content) return\n\n        $container.addClass('forum-loading')\n        ctx.fn.updater.addThread({ $root, forumEl: _forum, forumid, content })\n      })\n\n      $container.append(\n        $('<strong>', { text: _msg('add-thread-label') }),\n        $('<label>', { class: 'forum-input-container' }).append(\n          $('<div>').append($textArea),\n          $('<div>').append($submitBtn)\n        )\n      )\n\n      return $container\n    }\n\n    // 点赞容器\n    var reactionContainer = ctx => {\n      const { _forum, forumid, threadid, meta, fn } = ctx\n\n      const $container = $('<div>', { class: 'forum-reaction' })\n\n      // Like btn\n      let likeList = meta.reactionLike || ''\n      if (likeList) {\n        likeList = likeList.split('|')\n      } else {\n        likeList = []\n      }\n      let likeTotal = likeList.length\n      let isLike = likeList.includes(conf.wgUserName)\n\n      $likeBtn = $('<a>', {\n        href: 'javascript:;',\n        class: 'reaction-like',\n        text: `👍(${likeTotal})`,\n        title: isLike\n          ? _msg('reaction-like-remove')\n          : _msg('reaction-like-add'),\n      })\n        .addClass(isLike ? 'is-like' : 'not-like')\n        .click(function () {\n          $container.addClass('forum-loading')\n          if (isLike) {\n            let index = likeList.indexOf(conf.wgUserName)\n            if (index > -1) likeList.splice(index, 1)\n          } else {\n            likeList.push(conf.wgUserName)\n          }\n          likeList.sort()\n          likeList = likeList.join('|')\n          fn.updater.updateThread({\n            forumEl: _forum,\n            forumid,\n            threadid,\n            meta: { reactionLike: likeList },\n          })\n        })\n\n      $container.append($likeBtn)\n\n      return $container\n    }\n\n    // 新论坛容器\n    var newForumContainer = ctx => {\n      return $('<div>').append($('<p>', { text: 'newForumContainer' }))\n    }\n\n    // 无论坛容器\n    var noForumContainer = ctx => {}\n\n    var afterForum = ctx => {\n      return $('<div>', { class: 'forum-thread forum-add-thread' }).append(\n        newThreadArea(ctx)\n      )\n    }\n\n    var afterAllForums = ctx => {\n      return $('<div>', { class: 'after-all-forums' }).append(\n        newForumContainer(ctx)\n      )\n    }\n\n    // @function dateFormat\n    function dateFormat(fmt, date) {\n      date = date || new Date()\n      var o = {\n        'M+': date.getMonth() + 1, //月份\n        'd+': date.getDate(), //日\n        'h+': date.getHours(), //小时\n        'm+': date.getMinutes(), //分\n        's+': date.getSeconds(), //秒\n        'q+': Math.floor((date.getMonth() + 3) / 3), //季度\n        S: date.getMilliseconds(), //毫秒\n      }\n      if (/(y+)/.test(fmt)) {\n        fmt = fmt.replace(\n          RegExp.$1,\n          (date.getFullYear() + '').substr(4 - RegExp.$1.length)\n        )\n      }\n      for (var k in o)\n        if (new RegExp('(' + k + ')').test(fmt)) {\n          fmt = fmt.replace(\n            RegExp.$1,\n            RegExp.$1.length == 1\n              ? o[k]\n              : ('00' + o[k]).substr(('' + o[k]).length)\n          )\n        }\n      return fmt\n    }\n\n    next &&\n      next({\n        allForumsContainer,\n        forumContainer,\n        threadContainer,\n        afterAllForums,\n        afterForum,\n        noForumContainer,\n      })\n  })\n}\n"],"sourceRoot":""}